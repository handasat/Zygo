<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zygo</title>

  <style>
    body {
      font-family: Arial;
      direction: rtl;
      background: #f4f4f4;
      margin: 0;
    }

    .screen {
      display: none;
      background: #fff;
      padding: 20px;
      max-width: 400px;
      margin: 40px auto;
      border-radius: 10px;
    }
    .screen.active { display: block; }

    input, select, button {
      width: 100%;
      padding: 10px;
      margin-bottom: 12px;
      box-sizing: border-box;
      font-family: inherit;
    }

    button {
      background: black;
      color: white;
      border: none;
      cursor: pointer;
    }

    /* ===== Screen 1 ===== */
    #screen1{
      max-width: 1100px;
      background: linear-gradient(180deg, #f7efe3, #f4e6d5);
      border-radius: 18px;
      padding: 0;
      overflow: hidden;
    }
    #screen1 .s1-wrap{ padding: 18px 18px 90px; }
    #screen1 .s1-top{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; margin-bottom: 18px;
    }
    #screen1 .s1-pill{
      border: 2px solid rgba(0,0,0,.10);
      background: rgba(255,255,255,.35);
      border-radius: 999px;
      padding: 10px 14px;
      display:inline-flex;
      align-items:center;
      font-weight: 700;
      user-select:none;
    }
    #screen1 .s1-crumbs{
      flex: 1;
      text-align:center;
      color:#6b7280;
      font-weight: 700;
      white-space: nowrap;
    }
    #screen1 .s1-crumbs b{ color:#111; }

    #screen1 .s1-event{
      display:flex; gap:16px; align-items:flex-start;
      padding: 6px 0 18px;
    }
    #screen1 .s1-img{
      width: 92px; height: 92px;
      border-radius: 18px;
      object-fit: cover;
      background:#fff;
      box-shadow: 0 10px 30px rgba(0,0,0,.10);
    }
    #screen1 .s1-title{
      margin: 6px 0 8px;
      font-size: 28px;
      line-height: 1.15;
      font-weight: 900;
      letter-spacing: .2px;
    }
    #screen1 .s1-meta{
      display:flex; align-items:center; gap:8px;
      font-size: 16px;
      opacity:.85;
    }

    #screen1 .s1-card{
      background:#fff;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.10);
      padding: 18px;
      border: 1px solid rgba(0,0,0,.06);
    }
    #screen1 .s1-card-top{
      display:flex; align-items:center; justify-content:space-between;
      gap:14px; flex-wrap: wrap;
    }
    #screen1 .s1-qty{
      display:flex; align-items:center; gap:18px;
      background:#f6f2ea;
      border: 2px solid rgba(0,0,0,.10);
      border-radius: 999px;
      padding: 10px 14px;
      min-width: 170px;
      justify-content:space-between;
    }
    #screen1 .s1-qty .btn{
      width: 34px; height: 34px;
      border-radius: 999px;
      border: 2px solid rgba(0,0,0,.10);
      background:#fff;
      display:grid; place-items:center;
      font-size: 18px;
      font-weight: 900;
      user-select:none;
      cursor: pointer;
    }
    #screen1 .s1-qty .num{
      font-size: 26px;
      font-weight: 900;
    }

    #screen1 .s1-right{
      margin-inline-start: auto;
      text-align: right;
      min-width: 220px;
    }
    #screen1 .s1-ticket-name{
      font-weight: 900;
      font-size: 24px;
      margin: 0 0 6px;
    }
    #screen1 .s1-prices{
      display:flex; gap:10px; align-items:baseline;
      justify-content:flex-end;
    }
    #screen1 .s1-old{
      color:#6b7280;
      text-decoration: line-through;
      font-weight: 800;
      font-size: 18px;
    }
    #screen1 .s1-new{
      font-weight: 900;
      font-size: 26px;
      color:#3f3f46;
    }

    #screen1 .s1-divider{
      height: 2px;
      background: #7c3aed;
      margin: 14px 0 12px;
    }
    #screen1 .s1-bottom{
      display:flex; align-items:center; justify-content:flex-end;
      gap:10px;
      font-size: 14px;
      opacity:.88;
    }
    #screen1 .s1-info{
      width: 24px; height: 24px;
      border-radius: 999px;
      border: 2px solid rgba(0,0,0,.12);
      display:grid; place-items:center;
      font-weight: 900;
      background:#fff;
    }

    #screen1 .s1-actions{
      position: fixed;
      left: 0; right: 0;
      bottom: 18px;
      display:flex;
      justify-content:center;
      pointer-events:none;
    }
    #screen1 .s1-actions button{
      pointer-events:auto;
      width: min(1100px, calc(100% - 36px));
      padding: 16px 18px;
      border-radius: 999px;
      background: #2563eb;
      color:#fff;
      border:none;
      cursor:pointer;
      font-weight: 900;
      box-shadow: 0 10px 24px rgba(37,99,235,.25);
      margin-bottom: 0;
    }

    /* ===== Screen 2 ===== */
    #screen2{
      max-width: 1100px;
      background: linear-gradient(180deg, #f7efe3, #f4e6d5);
      border-radius: 18px;
      padding: 0;
      overflow: hidden;
    }
    #screen2 .s2-wrap{ padding: 18px 18px 90px; }
    #screen2 .s2-top{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; margin-bottom: 18px;
    }
    #screen2 .s2-pill{
      border: 2px solid rgba(0,0,0,.10);
      background: rgba(255,255,255,.35);
      border-radius: 999px;
      padding: 10px 14px;
      display:inline-flex;
      align-items:center;
      font-weight: 700;
      user-select:none;
      cursor:pointer;
    }
    #screen2 .s2-crumbs{
      flex: 1;
      text-align:center;
      color:#6b7280;
      font-weight: 700;
      white-space: nowrap;
    }
    #screen2 .s2-crumbs b{ color:#111; }

    #screen2 .s2-card{
      background:#fff;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0,0,0,.10);
      padding: 18px;
      border: 1px solid rgba(0,0,0,.06);
    }
    #screen2 .s2-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    #screen2 input, #screen2 select{
      width:100%;
      margin:0 !important;
      padding: 12px 14px !important;
      border-radius: 999px !important;
      border: 1.8px solid rgba(0,0,0,.12) !important;
      background:#fff;
      outline:none;
    }
    #screen2 select{
      appearance: none;
      background-image:
        linear-gradient(45deg, transparent 50%, rgba(0,0,0,.55) 50%),
        linear-gradient(135deg, rgba(0,0,0,.55) 50%, transparent 50%);
      background-position:
        calc(18px) calc(50% - 2px),
        calc(12px) calc(50% - 2px);
      background-size: 6px 6px, 6px 6px;
      background-repeat: no-repeat;
      padding-left: 34px !important;
    }

    #screen2 .s2-actions{
      position: fixed;
      left: 0; right: 0;
      bottom: 18px;
      display:flex;
      justify-content:center;
      gap: 12px;
      pointer-events:none;
    }
    #screen2 .s2-actions button{ pointer-events:auto; }
    #screen2 .s2-actions .primary{
      width: min(1100px, calc(100% - 36px));
      background: #2563eb !important;
      color:#fff !important;
      border: none !important;
      border-radius: 999px;
      padding: 14px 16px;
      font-weight: 900;
      box-shadow: 0 10px 24px rgba(37,99,235,.25);
      margin: 0;
    }

    /* ===== Screen 3 ===== */
    #screen3{
      max-width: 1100px;
      background: linear-gradient(180deg, #f7efe3, #f4e6d5);
      border-radius: 18px;
      padding: 0;
      overflow: hidden;
    }
    #screen3 .s3-wrap{ padding: 18px 18px 90px; }

    #screen3 .s3-top{
      display:flex; align-items:center; justify-content:space-between;
      gap:12px; margin-bottom: 18px;
    }
    #screen3 .s3-pill{
      border: 2px solid rgba(0,0,0,.10);
      background: rgba(255,255,255,.35);
      border-radius: 999px;
      padding: 10px 14px;
      display:inline-flex;
      align-items:center;
      font-weight: 700;
      user-select:none;
      cursor:pointer;
    }
    #screen3 .s3-crumbs{
      flex: 1;
      text-align:center;
      color:#6b7280;
      font-weight: 700;
      white-space: nowrap;
    }
    #screen3 .s3-crumbs b{ color:#111; }

    #screen3 .s3-event{
      display:flex; gap:16px; align-items:flex-start;
      padding: 6px 0 16px;
    }
    #screen3 .s3-img{
      width: 92px; height: 92px;
      border-radius: 18px;
      object-fit: cover;
      background:#fff;
      box-shadow: 0 10px 30px rgba(0,0,0,.10);
    }
    #screen3 .s3-title{
      margin: 6px 0 8px;
      font-size: 22px;
      line-height: 1.15;
      font-weight: 900;
    }
    #screen3 .s3-meta{
      display:flex; align-items:center; gap:8px;
      font-size: 14px;
      opacity:.85;
    }

    #screen3 .s3-summary{
      margin-top: 10px;
      border-top: 2px solid rgba(0,0,0,.10);
      border-bottom: 2px solid rgba(0,0,0,.10);
      padding: 14px 0;
      background: rgba(255,255,255,.4);
      border-radius: 14px;
    }
    #screen3 .s3-row{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding: 8px 0;
      font-weight: 700;
      opacity:.92;
    }
    #screen3 .s3-row .muted{
      font-weight: 700;
      opacity: .6;
      font-size: 13px;
      margin-top: 4px;
    }
    #screen3 .s3-divider{
      height: 1px;
      background: rgba(0,0,0,.10);
      margin: 8px 0;
    }

    /* âœ… ×§×•×¤×•×Ÿ ×§×˜×Ÿ + ××•×¦××“ ×œ×©×××œ */
    #screen3 .s3-coupon{
      display:flex;
      align-items:center;
      gap:10px;
      margin: 14px 0;
      max-width: 66%;
      margin-left: 0;
      margin-right: auto;
      justify-content: flex-start;
    }
    #screen3 .s3-coupon input{
      margin:0 !important;
      padding: 12px 14px !important;
      border-radius: 12px !important;
      border: 1.8px solid rgba(0,0,0,.12) !important;
      background:#fff;
      outline:none;
    }
    #screen3 .s3-coupon button{
      width: 120px !important;
      margin:0 !important;
      border-radius: 8px !important;
      padding: 12px 10px !important;
      background:#2563eb !important;
      color:#fff !important;
      font-weight: 900 !important;
      cursor:pointer;
    }

    /* âœ… ×˜×§×¡×˜ ×œ×™××™×Ÿ, ×¦×³×§×‘×•×§×¡ ××©×××œ */
    #screen3 .s3-checks{
      display:flex;
      flex-direction:column;
      gap: 12px;
      margin: 10px 0 18px;
      align-items: flex-end;
      text-align: right;
      font-family: Arial;
    }
    #screen3 .s3-checks label{
      width: 100%;
      display:flex;
      flex-direction: row-reverse; /* ×˜×§×¡×˜ ×‘×™××™×Ÿ, ×¦×³×§×‘×•×§×¡ ×‘×©×××œ */
      justify-content:flex-start;
      align-items:center;
      gap:10px;
      font-size: 14px;
      opacity:.9;
      font-family: Arial;
    }
    #screen3 .s3-checks label span{
      flex: 1;
      text-align: right;
    }
    #screen3 .s3-checks input[type="checkbox"]{
      width:auto !important;
      margin:0 !important;
      transform: scale(1.1);
    }

    #screen3 .s3-paycard{
      background:#fff;
      border-radius: 14px;
      border: 2px solid rgba(0,0,0,.10);
      box-shadow: 0 10px 30px rgba(0,0,0,.08);
      padding: 18px;
      max-width: 820px;
      margin: 0 auto;
    }
    #screen3 .s3-paygrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    #screen3 .s3-paygrid input{
      margin:0 !important;
      padding: 12px 14px !important;
      border-radius: 999px !important;
      border: 1.8px solid rgba(0,0,0,.12) !important;
      background:#fff;
      outline:none;
    }
    #screen3 .s3-paygrid .full{ grid-column: 1 / -1; }

    #screen3 .s3-actions{
      margin-top: 14px;
      display:flex;
      justify-content:center;
    }
    #screen3 .s3-actions button{
      width: 100% !important;
      padding: 16px 18px !important;
      border-radius: 999px !important;
      background:#2563eb !important;
      color:#fff !important;
      font-weight: 900 !important;
      box-shadow: 0 10px 24px rgba(37,99,235,.25);
      margin:0 !important;
      cursor:pointer;
    }

    @media (max-width: 820px){
      #screen1, #screen2, #screen3{ max-width: 420px; }
      #screen2 .s2-grid{ grid-template-columns: 1fr; }
      #screen3 .s3-paygrid{ grid-template-columns: 1fr; }

      #screen3 .s3-coupon{
        max-width: 100%;
        flex-direction: column;
        align-items: stretch;
      }
      #screen3 .s3-coupon button{
        width: 100% !important;
        border-radius: 12px !important;
      }
    }

    /* ===== Validation UI (ADDED) ===== */
    .invalid {
      border: 2px solid #dc2626 !important;
      outline: none !important;
    }
    .field-error {
      font-size: 12px;
      color: #dc2626;
      margin: 6px 0 10px;
      line-height: 1.2;
    }
  </style>
</head>

<body>
  <form id="nameForm">
    <!-- Screen 1 -->
    <div class="screen active" id="screen1">
      <div class="s1-wrap">
        <div class="s1-top">
          <div class="s1-pill">â† ×—×–×¨×”</div>
          <div class="s1-crumbs"><b>×›×¨×˜×™×¡×™×</b> â† ×”×›× ×¡ ×¤×¨×˜×™× â† ×ª×©×œ×•×</div>
          <div class="s1-pill">âœ•</div>
        </div>

        <div class="s1-event">
          <img class="s1-img" id="eventImage" src="YOUR_IMAGE_URL_HERE" alt="×ª××•× ×ª ××¡×™×‘×”">
          <div>
            <div class="s1-title" id="eventName">EXPO LAND / PURIM FESTIVAL</div>
            <div class="s1-meta">ğŸ“… March 5th 2026, 23:00</div>
          </div>
        </div>

        <!-- ×‘×—×™×¨×ª ×›×¨×˜×™×¡×™×: ×¨×’×™×œ + VIP ×‘××•×ª×” ×”×–×× ×” -->
        <div class="s1-card">
          <div class="s1-card-top" style="flex-direction:column; align-items:stretch;">

            <!-- Regular -->
            <div style="display:flex; align-items:center; justify-content:space-between; gap:14px; flex-wrap:wrap;">
              <div class="s1-qty" aria-label="×›××•×ª ×¨×’×™×œ">
                <div class="btn" id="regularPlus">+</div>
                <div class="num" id="regularQty">1</div>
                <div class="btn" id="regularMinus">âˆ’</div>
              </div>

              <div class="s1-right">
                <div class="s1-ticket-name">×›×¨×˜×™×¡ ×¨×’×™×œ</div>
                <div class="s1-prices">
                  <span class="s1-old" id="regularOld">399â‚ª</span>
                  <span class="s1-new" id="regularPrice" data-price="220">220.00â‚ª</span>
                </div>
              </div>
            </div>

            <div style="height:10px;"></div>

            <!-- VIP -->
            <div style="display:flex; align-items:center; justify-content:space-between; gap:14px; flex-wrap:wrap;">
              <div class="s1-qty" aria-label="×›××•×ª VIP">
                <div class="btn" id="vipPlus">+</div>
                <div class="num" id="vipQty">0</div>
                <div class="btn" id="vipMinus">âˆ’</div>
              </div>

              <div class="s1-right">
                <div class="s1-ticket-name">×›×¨×˜×™×¡ VIP</div>
                <div class="s1-prices">
                  <span class="s1-new" id="vipPrice" data-price="320">320.00â‚ª</span>
                </div>
              </div>
            </div>

          </div>

          <div class="s1-divider"></div>

          <div class="s1-bottom">
            <div class="s1-info">i</div>
            <div>×”××—×™×¨ ××ª×¢×“×›×Ÿ ××•×˜×•××˜×™×ª ×œ×¤×™ ×›××•×ª ×”×›×¨×˜×™×¡×™×</div>
          </div>
        </div>

        <div class="s1-actions">
          <button id="goNextBtn" type="button" onclick="nextScreen(1)">×”×ª×§×“× â€“ â‚ª 220.00</button>
        </div>
      </div>
    </div>

    <!-- Screen 2 -->
    <div class="screen" id="screen2">
      <div class="s2-wrap">
        <div class="s2-top">
          <div class="s2-pill" onclick="prevScreen(2)">×—×–×¨×”</div>
          <div class="s2-crumbs">×ª×©×œ×•× â† <b>×”×›× ×¡ ×¤×¨×˜×™×</b> â† ×›×¨×˜×™×¡×™×</div>
          <div class="s2-pill">âœ•</div>
        </div>

        <div class="s2-card">
          <div class="s2-grid">
            <input type="number" id="phoneNumber" placeholder="Phone Number" required>
            <input type="text" id="firstName" placeholder="First Name" required>

            <input type="text" id="lastName" placeholder="Last Name" required>
            <input type="date" id="birthDate" required>

            <input type="email" id="email" placeholder="Email" required>
            <select id="gender" required>
              <option value="">Gender</option>
              <option value="male">Male</option>
              <option value="female">Female</option>
              <option value="other">Other</option>
            </select>

            <input type="text" id="instagram" placeholder="Instagram">
            <input type="number" id="ID" placeholder="ID" required>
          </div>
        </div>

        <div class="s2-actions">
          <button id="toPaymentBtn" type="button" class="primary" onclick="nextScreen(2)">×”×‘× - â‚ª 220.00</button>
        </div>
      </div>
    </div>

    <!-- Screen 3 -->
    <div class="screen" id="screen3">
      <div class="s3-wrap">

        <div class="s3-top">
          <div class="s3-pill" onclick="prevScreen(3)">×—×–×¨×”</div>
          <div class="s3-crumbs"><b>×ª×©×œ×•×</b> â† ×”×›× ×¡ ×¤×¨×˜×™× â† ×›×¨×˜×™×¡×™×</div>
          <div class="s3-pill">âœ•</div>
        </div>

        <div class="s3-event">
          <img class="s3-img" src="YOUR_IMAGE_URL_HERE" alt="×ª××•× ×ª ××¡×™×‘×”">
          <div>
            <div class="s3-title">EXPO LAND / PURIM FESTIVAL</div>
            <div class="s3-meta">ğŸ“… March 5th 2026, 23:00</div>
          </div>
        </div>

        <!-- ×¡×™×›×•× ×”×–×× ×” ×“×™× ××™ -->
        <div class="s3-summary">
          <div id="orderSummary"></div>

          <div class="s3-divider"></div>

          <div class="s3-row">
            <div>×¡×š ×”×›×œ</div>
            <div id="orderTotal">â‚ª 0.00</div>
          </div>
        </div>

        <div class="s3-coupon">
          <input type="text" id="coupon" placeholder="×§×•×“ ×§×•×¤×•×Ÿ">
          <button type="button">×”×—×œ</button>
        </div>

        <div class="s3-checks">
          <label>
            <span>×× ×™ ×××©×¨ ××ª ×ª× ××™ ×”×©×™××•×©</span>
            <input type="checkbox" id="terms" required>
          </label>

          <label>
            <span>×× ×™ ×××©×¨ ×§×‘×œ×ª ×¢×“×›×•× ×™×</span>
            <input type="checkbox" id="updates">
          </label>
        </div>

        <div class="s3-paycard">
          <div class="s3-paygrid">
            <input class="full" type="number" id="creditCardNumber" placeholder="Credit Card Number" required>
            <input type="text" id="expire" placeholder="Expire (MM/YY)" required>
            <input type="number" id="cvv" placeholder="CVV" required>
          </div>

          <div class="s3-actions">
            <button id="payBtn" type="submit">×©×œ× â‚ª 0.00</button>
          </div>

          <div id="saveStatus" style="margin-top:10px; font-size:12px; opacity:.7; text-align:center;"></div>
        </div>
      </div>
    </div>
  </form>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <!-- × ×™×•×•×˜ (×œ×•×’×™×§×” × ×©××¨×ª) -->
  <script>
    function nextScreen(current) {
      document.getElementById(`screen${current}`).classList.remove("active");
      document.getElementById(`screen${current + 1}`).classList.add("active");
    }
    function prevScreen(current) {
      document.getElementById(`screen${current}`).classList.remove("active");
      document.getElementById(`screen${current - 1}`).classList.add("active");
    }
  </script>

  <!-- ×œ×•×’×™×§×ª ×›×¨×˜×™×¡×™× (×¤×œ×•×¡/××™× ×•×¡ + ××—×™×¨ + ×¡×™×›×•×) -->
  <script>
    (function () {
      // ××¦×‘ ×”×–×× ×” ×’×œ×•×‘×œ×™ ×›×“×™ ×©-firebase.js ×™×•×›×œ ×œ×§×¨×•×
      const orderState = {
        regularQty: 1,
        vipQty: 0,
        regularUnit: 220,
        vipUnit: 320
      };
      window.orderState = orderState;

      function readUnitPricesFromDOM() {
        const regularPriceEl = document.getElementById("regularPrice");
        const vipPriceEl = document.getElementById("vipPrice");
        if (regularPriceEl) orderState.regularUnit = Number(regularPriceEl.dataset.price || 220);
        if (vipPriceEl) orderState.vipUnit = Number(vipPriceEl.dataset.price || 320);
      }

      function totalQty() {
        return orderState.regularQty + orderState.vipQty;
      }

      function totalAmount() {
        return (orderState.regularQty * orderState.regularUnit) + (orderState.vipQty * orderState.vipUnit);
      }

      function formatILS(n) {
        return `â‚ª ${Number(n).toFixed(2)}`;
      }

      function canDecrement(type) {
        // ×œ× ×××¤×©×¨×™× ×œ×”×’×™×¢ ×œ-0 ×›×¨×˜×™×¡×™× ×‘×¡×š ×”×›×œ
        if (totalQty() <= 1) {
          if (type === "regular" && orderState.regularQty === 1 && orderState.vipQty === 0) return false;
          if (type === "vip" && orderState.vipQty === 1 && orderState.regularQty === 0) return false;
        }
        return true;
      }

      function renderSummaryScreen3() {
        const summaryEl = document.getElementById("orderSummary");
        const totalEl = document.getElementById("orderTotal");
        const payBtn = document.getElementById("payBtn");
        if (!summaryEl || !totalEl) return;

        const rows = [];

        if (orderState.regularQty > 0) {
          rows.push(`
            <div class="s3-row">
              <div>
                ×›×¨×˜×™×¡ ×¨×’×™×œ
                <div class="muted">${orderState.regularQty} x ${formatILS(orderState.regularUnit)}</div>
              </div>
              <div>${formatILS(orderState.regularQty * orderState.regularUnit)}</div>
            </div>
          `);
        }

        if (orderState.vipQty > 0) {
          rows.push(`
            <div class="s3-row">
              <div>
                ×›×¨×˜×™×¡ VIP
                <div class="muted">${orderState.vipQty} x ${formatILS(orderState.vipUnit)}</div>
              </div>
              <div>${formatILS(orderState.vipQty * orderState.vipUnit)}</div>
            </div>
          `);
        }

        summaryEl.innerHTML = rows.join(`<div class="s3-divider"></div>`);
        totalEl.textContent = formatILS(totalAmount());
        if (payBtn) payBtn.textContent = `×©×œ× ${formatILS(totalAmount())}`;
      }

      function updateButtonsAndTotals() {
        // Screen 1 qty
        const regularQtyEl = document.getElementById("regularQty");
        const vipQtyEl = document.getElementById("vipQty");
        if (regularQtyEl) regularQtyEl.textContent = String(orderState.regularQty);
        if (vipQtyEl) vipQtyEl.textContent = String(orderState.vipQty);

        // Buttons: next (screen1) + next (screen2) show current total
        const goNextBtn = document.getElementById("goNextBtn");
        const toPaymentBtn = document.getElementById("toPaymentBtn");
        if (goNextBtn) goNextBtn.textContent = `×”×ª×§×“× â€“ ${formatILS(totalAmount())}`;
        if (toPaymentBtn) toPaymentBtn.textContent = `×”×‘× - ${formatILS(totalAmount())}`;

        // Screen 3 summary
        renderSummaryScreen3();
      }

      function bindQtyButtons() {
        readUnitPricesFromDOM();

        const regularPlus = document.getElementById("regularPlus");
        const regularMinus = document.getElementById("regularMinus");
        const vipPlus = document.getElementById("vipPlus");
        const vipMinus = document.getElementById("vipMinus");

        if (regularPlus) regularPlus.addEventListener("click", () => {
          orderState.regularQty += 1;
          updateButtonsAndTotals();
        });

        if (regularMinus) regularMinus.addEventListener("click", () => {
          if (orderState.regularQty > 0 && canDecrement("regular")) {
            orderState.regularQty -= 1;
            updateButtonsAndTotals();
          }
        });

        if (vipPlus) vipPlus.addEventListener("click", () => {
          orderState.vipQty += 1;
          updateButtonsAndTotals();
        });

        if (vipMinus) vipMinus.addEventListener("click", () => {
          if (orderState.vipQty > 0 && canDecrement("vip")) {
            orderState.vipQty -= 1;
            updateButtonsAndTotals();
          }
        });

        updateButtonsAndTotals();
      }

      // ×¢×•×˜×¤×™× nextScreen ×›×“×™ ×œ×¢×“×›×Ÿ ×¡×™×›×•× ×›×©××’×™×¢×™× ×œ××¡×š 3 (×‘×œ×™ ×œ×©×‘×•×¨ ×œ×•×’×™×§×”)
      const originalNextScreen = window.nextScreen;
      window.nextScreen = function (current) {
        originalNextScreen(current);
        if (current + 1 === 3) {
          renderSummaryScreen3();
        }
      };

      document.addEventListener("DOMContentLoaded", bindQtyButtons);
    })();
  </script>

  <!-- âœ… VALIDATION (ADDED) - blocks submit before firebase.js if invalid -->
  <script>
    (function () {
      const MSG = "×©×“×” ×œ× ×ª×§×™×Ÿ";

      function getOrCreateErrorEl(input) {
        const id = input.id + "-error";
        let el = document.getElementById(id);
        if (!el) {
          el = document.createElement("div");
          el.id = id;
          el.className = "field-error";
          el.style.display = "none";
          input.insertAdjacentElement("afterend", el);
        }
        return el;
      }

      function setInvalid(input, isInvalid) {
        const errEl = getOrCreateErrorEl(input);
        if (isInvalid) {
          input.classList.add("invalid");
          errEl.textContent = MSG;
          errEl.style.display = "block";
        } else {
          input.classList.remove("invalid");
          errEl.textContent = "";
          errEl.style.display = "none";
        }
      }

      // xxxx-xxxx-xxxx-xxxx
      function isCardValid(v) {
        return /^\d{4}-\d{4}-\d{4}-\d{4}$/.test(String(v || "").trim());
      }

      // xxx
      function isCvvValid(v) {
        return /^\d{3}$/.test(String(v || "").trim());
      }

      // MM/YY and not expired
      function isExpireValid(v) {
        const s = String(v || "").trim();
        if (!/^\d{2}\/\d{2}$/.test(s)) return false;

        const [mmStr, yyStr] = s.split("/");
        const mm = Number(mmStr);
        const yy = Number(yyStr);

        if (!Number.isInteger(mm) || mm < 1 || mm > 12) return false;
        if (!Number.isInteger(yy) || yy < 0 || yy > 99) return false;

        const fullYear = 2000 + yy;

        // valid through the end of expiry month:
        // compare now < first day of next month
        const expiryEnd = new Date(fullYear, mm, 1);
        const now = new Date();

        return now < expiryEnd;
      }

      // Israeli ID checksum (9 digits including leading zeros)
      function isIsraeliIdValid(v) {
        const id = String(v || "").trim();
        if (!/^\d{9}$/.test(id)) return false;

        let sum = 0;
        for (let i = 0; i < 9; i++) {
          let num = Number(id.charAt(i)) * ((i % 2) + 1);
          if (num > 9) num = (num % 10) + Math.floor(num / 10);
          sum += num;
        }
        return (sum % 10) === 0;
      }

      // exact: 05x - xxx - xxxx (with spaces)
      function isPhoneValid(v) {
        return /^05\d - \d{3} - \d{4}$/.test(String(v || "").trim());
      }

      // use HTML5 email validation + simple regex fallback
      function isEmailValid(value, inputEl) {
        const v = String(value || "").trim();

        if (inputEl && typeof inputEl.checkValidity === "function") {
          if (!inputEl.checkValidity()) return false;
        }

        return /^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/.test(v);
      }

      function validateField(input) {
        if (!input) return true;

        const id = input.id;
        const val = input.value; // DOM always string

        let ok = true;

        if (id === "creditCardNumber") ok = isCardValid(val);
        else if (id === "cvv") ok = isCvvValid(val);
        else if (id === "expire") ok = isExpireValid(val);
        else if (id === "ID") ok = isIsraeliIdValid(val);
        else if (id === "phoneNumber") ok = isPhoneValid(val);
        else if (id === "email") ok = isEmailValid(val, input);

        setInvalid(input, !ok);
        return ok;
      }

      function validateAll() {
        const fields = [
          document.getElementById("creditCardNumber"),
          document.getElementById("cvv"),
          document.getElementById("expire"),
          document.getElementById("ID"),
          document.getElementById("phoneNumber"),
          document.getElementById("email"),
        ];

        let allOk = true;
        for (const f of fields) {
          if (f && !validateField(f)) allOk = false;
        }
        return allOk;
      }

      document.addEventListener("DOMContentLoaded", () => {
        const form = document.getElementById("nameForm");
        if (!form) return;

        // live validation
        const ids = ["creditCardNumber", "cvv", "expire", "ID", "phoneNumber", "email"];
        ids.forEach((fid) => {
          const el = document.getElementById(fid);
          if (!el) return;
          el.addEventListener("input", () => validateField(el));
          el.addEventListener("blur", () => validateField(el));
        });

        // capture submit BEFORE firebase.js
        form.addEventListener("submit", (e) => {
          const ok = validateAll();
          if (!ok) {
            e.preventDefault();
            e.stopImmediatePropagation(); // stops firebase.js submit handler
          }
        }, true);
      });
    })();
  </script>

  <!-- firebase.js (UNCHANGED) -->
  <script src="firebase.js" defer></script>
</body>
</html>
